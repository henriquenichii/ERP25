{% extends "base.html" %}

{% block title %}Detalhes do Pedido - Divino Doces Finos ERP{% endblock %}

{% block content %}
    <div id="detalhes-pedido">
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-3xl font-bold text-gray-800">Detalhes do Pedido <span id="detalhe-pedido-id" class="text-blue-600 text-xl"></span></h2>
            <div class="flex items-center space-x-2">
                <span id="detalhe-status-indicator" class="w-3 h-3 rounded-full"></span>
                <span id="detalhe-status-text" class="text-lg font-semibold text-gray-700"></span>
            </div>
        </div>

        <div class="flex justify-between mb-6">
            <button id="btn-editar-pedido" class="btn-secondary">Editar Pedido</button>
            <button id="btn-gerar-comprovante" class="btn-primary">Gerar Comprovante de Retirada</button>
            <a href="{{ url_for('main_pages.list_pedidos_page') }}" class="btn-secondary">Voltar para lista</a>
        </div>

        <div class="space-y-6">
            <!-- INFORMAÇÕES DO CLIENTE -->
            <div class="bg-gray-50 p-6 rounded-lg shadow-inner">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">Informações do Cliente</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Nome Completo:</label>
                        <p id="detalhe-cliente-nome" class="text-gray-900 mt-1"></p>
                        <input type="text" id="edit-cliente-nome" class="input-field editable-field hidden">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Telefone:</label>
                        <p id="detalhe-cliente-telefone" class="text-gray-900 mt-1"></p>
                        <input type="text" id="edit-cliente-telefone" class="input-field editable-field hidden">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700">E-mail:</label>
                        <p id="detalhe-cliente-email" class="text-gray-900 mt-1"></p>
                        <input type="email" id="edit-cliente-email" class="input-field editable-field hidden">
                    </div>
                    <!-- NOVOS CAMPOS DO CLIENTE (RG, CPF) -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700">RG do Contratante:</label>
                        <p id="detalhe-cliente-rg" class="text-gray-900 mt-1"></p>
                        <input type="text" id="edit-cliente-rg" class="input-field editable-field hidden">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700">CPF do Contratante:</label>
                        <p id="detalhe-cliente-cpf" class="text-gray-900 mt-1"></p>
                        <input type="text" id="edit-cliente-cpf" class="input-field editable-field hidden">
                    </div>
                    <div class="md:col-span-2">
                        <label class="block text-sm font-medium text-gray-700">Observações Gerais:</label>
                        <p id="detalhe-observacoes-gerais-cliente" class="text-gray-900 mt-1"></p>
                        <textarea id="edit-observacoes-gerais-cliente" rows="2" class="input-field editable-field hidden"></textarea>
                    </div>
                </div>
            </div>

            <!-- INFORMAÇÕES DO CONTRATADO (Divino Doces Finos) -->
            <div class="bg-gray-50 p-6 rounded-lg shadow-inner">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">Informações do Contratado</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Nome da Empresa:</label>
                        <p id="detalhe-nome-contratado" class="text-gray-900 mt-1"></p>
                        <input type="text" id="edit-nome-contratado" class="input-field editable-field hidden">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700">CNPJ:</label>
                        <p id="detalhe-cnpj-contratado" class="text-gray-900 mt-1"></p>
                        <input type="text" id="edit-cnpj-contratado" class="input-field editable-field hidden">
                    </div>
                </div>
            </div>

            <!-- DETALHES DO PEDIDO -->
            <div class="bg-gray-50 p-6 rounded-lg shadow-inner">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">Detalhes do Pedido</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Tipo de Produto:</label>
                        <p id="detalhe-tipo-pedido" class="text-gray-900 mt-1"></p>
                        <select id="edit-tipo-pedido" class="input-field editable-field hidden">
                            <option value="Bem-casados">Bem-casados</option>
                            <option value="Doces finos">Doces finos</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Data do Evento:</label>
                        <p id="detalhe-data-evento" class="text-gray-900 mt-1"></p>
                        <input type="date" id="edit-data-evento" class="input-field editable-field hidden">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Data de Retirada:</label>
                        <p id="detalhe-data-retirada" class="text-gray-900 mt-1"></p>
                        <input type="date" id="edit-data-retirada" class="input-field editable-field hidden">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Horário de Retirada:</label>
                        <p id="detalhe-horario-retirada" class="text-gray-900 mt-1"></p>
                        <input type="time" id="edit-horario-retirada" class="input-field editable-field hidden">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Quantidade Total:</label>
                        <p id="detalhe-quantidade" class="text-gray-900 mt-1"></p>
                        <input type="number" id="edit-quantidade" class="input-field editable-field hidden">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Tipo de Embalagem:</label>
                        <p id="detalhe-tipo-embalagem" class="text-gray-900 mt-1"></p>
                        <select id="edit-tipo-embalagem" class="input-field editable-field hidden">
                            <option value="Simples">Simples</option>
                            <option value="Especial">Especial</option>
                            <option value="Personalizada">Personalizada</option>
                        </select>
                    </div>
                    <div class="md:col-span-2">
                        <label class="block text-sm font-medium text-gray-700">Sabores:</label>
                        <p id="detalhe-sabores" class="text-gray-900 mt-1"></p>
                        <textarea id="edit-sabores" rows="3" class="input-field editable-field hidden"></textarea>
                    </div>
                    <div class="md:col-span-2">
                        <label class="block text-sm font-medium text-gray-700">Observações Específicas:</label>
                        <p id="detalhe-observacoes" class="text-gray-900 mt-1"></p>
                        <textarea id="edit-observacoes" rows="3" class="input-field editable-field hidden"></textarea>
                    </div>
                    <!-- NOVOS CAMPOS DO CONTRATO (Valor Total, Data Pagamento, Local Evento) -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Valor Total Contrato:</label>
                        <p id="detalhe-valor-total-contrato" class="text-gray-900 mt-1"></p>
                        <input type="text" id="edit-valor-total-contrato" class="input-field editable-field hidden">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Data Pagamento Contrato:</label>
                        <p id="detalhe-data-pagamento-contrato" class="text-gray-900 mt-1"></p>
                        <input type="date" id="edit-data-pagamento-contrato" class="input-field editable-field hidden">
                    </div>
                    <div class="md:col-span-2">
                        <label class="block text-sm font-medium text-gray-700">Local do Evento:</label>
                        <p id="detalhe-local-evento" class="text-gray-900 mt-1"></p>
                        <input type="text" id="edit-local-evento" class="input-field editable-field hidden">
                    </div>
                </div>
            </div>

            <!-- TABELA DE PRODUTOS CONTRATADOS -->
            <div class="bg-gray-50 p-6 rounded-lg shadow-inner">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">Produtos Contratados</h3>
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Quantidade</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Produto</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Valor Unitário</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Valor Total Item</th>
                            </tr>
                        </thead>
                        <tbody id="produtos-contratados-table-body" class="bg-white divide-y divide-gray-200">
                            <!-- As linhas da tabela serão preenchidas por JavaScript -->
                        </tbody>
                    </table>
                    <p id="no-produtos-contratados-message" class="text-center text-gray-500 mt-4 hidden">Nenhum produto contratado encontrado.</p>
                </div>
            </div>

            <div class="bg-gray-50 p-6 rounded-lg shadow-inner">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">Histórico de Interações</h3>
                <ul id="historico-lista" class="space-y-2">
                </ul>
                <p id="no-historico-message" class="text-center text-gray-500 mt-4 hidden">Nenhum histórico disponível.</p>
            </div>

            <div class="bg-gray-50 p-6 rounded-lg shadow-inner">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">Confirmação via WhatsApp <span class="text-gray-500 text-sm">(Funcionalidade Futura)</span></h3>
                <p class="text-gray-700">Status: <span class="font-semibold text-gray-600">⏳ Aguardando</span></p>
                <p class="text-gray-700">Última Resposta: N/A</p>
                <div class="mt-4">
                    <label for="anotacao-whatsapp" class="block text-sm font-medium text-gray-700">Anotação Manual da Conversa:</label>
                    <textarea id="anotacao-whatsapp" rows="2" class="input-field" placeholder="Anote detalhes da conversa aqui" disabled></textarea>
                </div>
                <button class="btn-secondary mt-4" disabled>Visualizar Histórico (API)</button>
            </div>

            <div id="admin-actions" class="flex justify-end space-x-4 mt-6 hidden">
                <button id="btn-salvar-edicao" class="btn-primary">Salvar Alterações</button>
                <button id="btn-cancelar-edicao" class="btn-secondary">Cancelar Edição</button>
                <button id="btn-cancelar-pedido" class="bg-red-600 text-white px-6 py-3 rounded-lg shadow-md hover:bg-red-700 transition duration-300 ease-in-out">Cancelar Pedido</button>
            </div>
        </div>
    </div>
{% endblock %}
